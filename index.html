<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Attivi Portfolio</title>
    <link rel="icon" type="image/png" href="favicon.png"> 
    <link rel="stylesheet" href="css/trade.css">
	<link rel="stylesheet" href="css/panoramica.css">
    <link rel="stylesheet" href="css/menusotto.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div style="padding: 4px;"></div>
<div class="container">
<!-- Titolo a sinistra, sottotitolo a destra -->
<div class="container">
<div class="container-f" style="display:flex; align-items:center; justify-content:space-between; padding:4px 0;">
  <h1 style="margin:0; font-size:1.75rem; line-height:1.8;">ðŸ”¥ Trade Attivi e Panoramica</h1>

  <div style="font-size:0.9rem; line-height:1.3; color:#fff; text-align:right; padding-right: 10px;">
    <em>*Gestione <strong>Trade</strong> Singoli con Accumulo e Prezzo Medio.</em>
  </div>
</div>
</div>
<div style="padding: 4px;"></div> 
 <div class="container" style="padding-top: 12px; padding-bottom: 12px;">
  <!-- BLOCCO MENU -->
  <div class="iflow-body">
    <nav class="iflow-custom-menu">
      <ul>
        <li>
          <div class="iflow-menu-label"><a href="https://beneinst.github.io/tradingspot/">Trade</a></div>
          <ul>
            <li><a href="https://beneinst.github.io/tradingspot/">Trade attivi</a></li>
          </ul>
        </li>
		 
        <li>
          <div class="iflow-menu-label"><a href="https://beneinst.github.io/tradingspot/operativita.html">OperativitÃ </a></div>
          <ul>
            <li><a href="https://beneinst.github.io/tradingspot/operativita.html">OperativitÃ </a></li>
			<li><a href="https://beneinst.github.io/tradingspot/traking.html">Traking</a></li>
          </ul>
        </li>
       
        <li>
          <div class="iflow-menu-label">Strategia</div>
          <ul>
		  <li><a href="https://beneinst.github.io/tradingspot/blocco-note.html">Blocco Note</a></li>
            
            <li><a href="https://beneinst.github.io/tradingspot/Strategia-Trading.html">Indicatore 4H</a></li>
            <li><a href="https://beneinst.github.io/tradingspot/chartflow/index.html">Segnali</a></li>
          </ul>
        </li>
        <li>
          <div class="iflow-menu-label">Fondamenti</div>
          <ul>
		  <li><a href="https://beneinst.github.io/tradingspot/regole-trading.html">Regole</a></li>
            <li><a href="https://beneinst.github.io/tradingspot/cheat-sheet.html">Patterns</a></li>
            <li><a href="https://beneinst.github.io/tradingspot/candlestick.html">Candlestick</a></li>
          </ul>
        </li>
		<li>
          <div class="iflow-menu-label"><a href="https://beneinst.github.io/tradingspot/backup.html">Backup</a></div>
          <ul>
            <li><a href="https://beneinst.github.io/tradingspot/backup.html">Backup</a></li>
          </ul>
        </li>
		
      </ul>
    </nav>
  </div>
  </div>       
   <div style="padding: 4px;"></div>             
      
   <div class="container">

        <div class="card">
            <h5 class="section-title" style="color: #FFD801 !important;">ðŸ’± Aggiungi Entry al Trade</h5>
            <form id="trade-form" class="trade-form">
                <div class="form-row">
                    <label for="crypto-symbol" style="color: #BCC6CC !important;">SIMBOLO CRIPTO</label>
                    <input type="text" id="crypto-symbol" placeholder="BTC" required>
                </div>
                <div class="form-row">
                    <label for="trade-quantity" style="color: #BCC6CC !important;">QUANTITA'</label>
                    <input type="number" id="trade-quantity" step="0.00000001" placeholder="0.00000000" required>
                </div>
                <div class="form-row">
                    <label for="trade-price" style="color: #BCC6CC !important;">IMPORTO ENTRY(USDT):</label>
                    <input type="number" id="invested-amount" placeholder="Importo investito ($)" step="0.01" required>
                </div>
                <div class="form-row">
                    <label></label>
                    <button type="submit" class="btn-edit" style="font-size:1.1rem; padding:9px 22px;min-width:220px;margin-right:20px;">Aggiungi Entry</button>
                </div>
                <input type="hidden" id="edit-trade-id">
            </form>
        </div>

        <div class="form-container">
            <h4 class="section-title" style="color: #FFD801 !important;">ðŸŽ¯ I tuoi Trade Attivi</h4>
            <div id="trades-container"></div>
        </div>
		
		
		<div id="trade-counter" style="display: none;">
  ðŸ“Š Trade attivi: <span id="trade-count" style="display: inline;">0</span>
</div>
		
		<div class="card">
		<h5 class="section-title" style="color: #FFD801 !important;">ðŸª” Storico Distribuzione Capitale</h5>
	<div style="display: flex; gap: 20px; align-items: flex-start; justify-content: space-between; flex-wrap: wrap;">

  <!-- Colonna sinistra: Scheda Gestione Trade -->

  <div class="header-stat-item_f">
  <div class="container_f" style="display: flex; flex-direction: column; gap: 0px;">
    <div class="header-stat-item">
      <div class="stat-label">Totale in Cripto</div>
      <div class="stat-value totale" style="color: #f62817; font-size: 36px;" id="totaleIn"></div>
    </div>
    
    <div class="header-stat-item">
      <div class="stat-label">Restanti in Dollari</div>
      <div class="stat-value capitale" style="color: #1AA6ED; font-size: 36px;" id="capitale"></div>
    </div>
  </div>
</div>

  <!-- Colonna destra: Grafico -->
  <div class="header-stat-item_f" style="flex: 1 1 48%;  padding: 1px; border-radius: 8px;">
    <canvas id="capitaleChart"></canvas>
  </div>

</div>

<!-- Gruppo unico: tutti i box -->
<div class="form-container">

  <div class="header-stats all-in-one">
    <!-- 1Â° riga (primi 5) -->
    <div class="header-stat-item">
      <div class="header-stat-label">Trade Totali</div>
      <div class="header-stat-value" style="color: #987654; font-size: 28px;" id="totaleTrade">30</div>
    </div>

    <div class="header-stat-item">
      <div class="header-stat-label" >$ per Trade</div>
      <div class="header-stat-value" style="display: flex; align-items: center; gap: 6px;">
        <input type="number" style="font-size: 22px; width: 64px;" id="quotaPerTrade" class="quota-input" value="0" min="1" oninput="aggiornaCapitale()">
        <button onclick="aggiornaTrade()" class="btn-danger btn-tiny" title="Aggiorna Capitale">ðŸŽ¯</button>
      </div>
    </div>

    <div class="header-stat-item">
      <div class="header-stat-label">Capitale Totale</div>
      <div class="header-stat-value" style="color: #f5f5f5; font-size: 28px;" id="capitaleTotale"></div>
    </div>

    <div class="header-stat-item">
      <div class="header-stat-label">Capitale Restante</div>
      <div class="header-stat-value" style="color: #3BB9FF; font-size: 28px;" id="capitaleInDollari"></div>
    </div>

    <div class="header-stat-item">
      <div class="header-stat-label">Totale In Cripto</div>
      <div class="header-stat-value" style="color: #f62817; font-size: 28px;" id="totaleInDollari"></div>
    </div>

    <!-- 2Â° riga (secondari) -->
    <div class="header-stat-item">
      <div class="header-stat-label">Media Trade Attivi</div>
      <div class="header-stat-value" style="color: #f62817; font-size: 28px;" id="mediaTradeTotaleIn">0</div>
    </div>

    <div class="header-stat-item">
      <div class="header-stat-label">Media Dollari in USDT</div>
      <div class="header-stat-value" style="color: #1aa6ed; font-size: 28px;" id="mediaDollariTrading">$0</div>
    </div>
  </div>

</div></div>
    

  
  
  <!-- Nuova card per il grafico storico -->
 <div class="card">
   
    
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button active" onclick="cambiaTab(event, 'tab-distribuzione')">Distribuzione nel Tempo</button>
        <button class="tab-button" onclick="cambiaTab(event, 'tab-percentuale')">Analisi Percentuale</button>
      </div>
      
      <div class="tab-content">
        <div id="tab-distribuzione" class="tab-panel active">
          <!-- GRAFICO PRIMA DEL MENU -->
          <div class="storico-chart-container">
            <canvas id="storicoCapitaleChart"></canvas>
          </div>
          
          <!-- MENU TEMPORALE SOTTO IL GRAFICO -->
          <div class="time-range-selector" style="margin-top: 30px;">
            <button class="btn-danger active" data-days="30" onclick="cambiaRangeTempo(this)">30 Giorni</button>
            <button class="btn-danger" data-days="90" onclick="cambiaRangeTempo(this)">90 Giorni</button>
            <button class="btn-danger" data-days="180" onclick="cambiaRangeTempo(this)">6 Mesi</button>
            <button class="btn-danger" data-days="365" onclick="cambiaRangeTempo(this)">1 Anno</button>
            <button class="btn-danger" data-days="all" onclick="cambiaRangeTempo(this)">Tutto</button>
            <!-- NUOVO PULSANTE -->
            <button class="btn-edit" onclick="scaricaGrafico()" style="margin-left: 15px;">ðŸ“· Scarica Grafico</button>
          </div>
          
         

        </div>
        
        <div id="tab-percentuale" class="tab-panel">
          <div class="info-box">
            Analisi del tempo in cui il capitale Ã¨ stato allocato nelle seguenti percentuali in dollari.
          </div>
          
          <!-- GRAFICO PERCENTUALE SPOSTATO PRIMA DEI BOX -->
          <div class="storico-chart-container">
            <canvas id="percentualeCapitaleChart"></canvas>
          </div>
          
          
          
          <!-- BOX PERCENTUALI SPOSTATI SOTTO IL GRAFICO -->
          <div class="distribution-stats">
            <div class="distribution-item">
              <div class="distribution-label">0-25% in Dollari</div>
              <div class="distribution-value" style="color: #3BB9FF; font-size: 30px;" id="percentuale0_25">0 giorni</div>
            </div>
            <div class="distribution-item">
              <div class="distribution-label">25-50% in Dollari</div>
              <div class="distribution-value" style="color: #3BB9FF; font-size: 30px;" id="percentuale25_50">0 giorni</div>
            </div>
            <div class="distribution-item">
              <div class="distribution-label">50-75% in Dollari</div>
              <div class="distribution-value" style="color: #3BB9FF; font-size: 30px;" id="percentuale50_75">0 giorni</div>
            </div>
            <div class="distribution-item">
              <div class="distribution-label">75-100% in Dollari</div>
              <div class="distribution-value" style="color: #3BB9FF; font-size: 30px;" id="percentuale75_100">0 giorni</div>
            </div>
			<button onclick="scaricaGraficoPercentuale1()" class="header-stat-item" style="margin-top: 15px; margin-bottom: 20px;">
            <i class="fas fa-download"></i> Scarica Grafico Percentuale
          </button>
          </div>
        </div>
      </div>
    </div>
</div>
<span id="infoTotaleTrade"></span></div></div>
<div style="padding: 2px;"></div>
</div>


		
		
     
		
		
	<!-- FOOTER -->

<div style="padding: 4px;"></div>  

<div class="container">
  <div class="container-f" style="padding-top: 1px; padding-bottom: 1px;">
    <div style="display: flex; align-items: center; justify-content: space-between;">
      <p style="margin: 0; color: #c3c3c3; text-align: left; height: 10px; line-height: 12px;">
        Â© 2025 Invest Flow | Trading Spot di Gerardo D'Orrico â€“ Tutti i diritti riservati.
      </p>
      <img src="images/logoinvest2.svg"
           alt="Invest Flow"
           style="height: 40px; width: auto; margin-left: 16px;" />
    </div>
  </div>
</div>
<div style="padding: 4px;"></div>

<div style="display:none;">
  <div id="totaleIn"></div>
  <div id="capitale"></div>
  <div id="totaleTrade"></div>
  <div id="infoTotaleTrade"></div>
  <input id="quotaPerTrade" type="number">
  <input id="inputTotaleIn" type="number">
  <div id="capitaleTotale"></div>
  <div id="capitaleInDollari"></div>
  <div id="totaleInDollari"></div>
  <span id="mediaTradeTotaleIn"></span>
  <span id="mediaDollariTrading"></span>
  <canvas id="capitaleChart"></canvas>
  <canvas id="storicoCapitaleChart"></canvas>
  <canvas id="percentualeCapitaleChart"></canvas>
</div>

<script src="js/trade.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.9/dist/chart.umd.min.js"></script>
<script src="js/panoramica.js"></script>
<script>
// ðŸ”„ Contatore reattivo trade attivi
function updateTradeCount() {
  const trades = JSON.parse(localStorage.getItem('singleTrades') || '[]');
  const count = trades.length;
  const span = document.getElementById('trade-count');
  if (span) span.textContent = count;
}

// ðŸ“¡ Ascolta eventi di apertura/chiusura trade
window.addEventListener('storage', (e) => {
  if (e.key === '__tradeEvent__') {
    updateTradeCount();
  }
});

// ðŸ§  Aggiorna anche al caricamento pagina
document.addEventListener('DOMContentLoaded', updateTradeCount);
</script>


</body>
</html>